---
# =============================================================================
# OpenClaw Configuration Playbook - Phases 5 & 6
# =============================================================================
# Configures model failover, custom providers (LLMKube), and optional
# browser automation.
#
# Usage:
#   ansible-playbook playbooks/configure.yml --ask-vault-pass --ask-become-pass
#
#   # Enable browser automation:
#   ansible-playbook playbooks/configure.yml --ask-vault-pass --ask-become-pass \
#     -e openclaw_browser_enabled=true --tags browser
#
# Prerequisite: harden.yml must have been run.

- name: "Phase 5 & 6: Integrations and Browser Automation"
  hosts: mac-mini
  gather_facts: true

  roles:
    - role: openclaw_integrations
      tags: [integrations, config]

    - role: openclaw_browser
      become: true
      become_user: "{{ openclaw_user }}"
      tags: [browser]

    # Re-run harden to merge integration/browser config into openclaw.json
    - role: openclaw_harden
      become: true
      become_user: "{{ openclaw_user }}"
      tags: [integrations, browser, config]
